package team037;

import battlecode.common.*;
import team037.NeuralNet.FeedForwardNeuralNet;
import team037.Utilites.FightMicroUtilites;

public class FightMicro
{
    public static RobotController rc;
    public static FeedForwardNeuralNet net;
    public static double[][] weights;

    public FightMicro(RobotController robotController)
    {
        rc = robotController;
        weights = new double[][] {
                {
                        -0.8007118367397824, 4.67867033912814, 2.879063972781921, -1.3203605103622138, 1.0441692284658035, -3.7607679540030268, 4.9064948895372265, -2.9260454834883083, 0.8363418062372265, -1.262146476935937, 3.922593502116103, -3.790012259993078, 0.7142352366152129, -0.1430859011919685, -0.33407830699453356, -1.3791391737340195, -2.6758266417205023, -0.34983463323399744, -1.9055806323415774, -0.4709539570199207, -3.1087519381693873, 0.326972979677711, 1.049602942567021, -2.310452749458595, -4.7835852059429875, 0.257597553357981, -1.6888202037056619, 2.744320414186318, 3.019544623800254, -1.9358444217780022, 0.5270072657064621, 2.7606439893126433, 2.894624470441862, -0.23903205385260373, 2.8452937287501405, -2.1938547085018003, -3.935402182729942, 1.9069899690923702, -6.048290090897, 0.9190409388431067, 0.7921156173588386, 1.3720011838364925, 1.5361154389401208, -0.7499555161417173, -0.3833616061090877, 2.3724007847638098, -4.638701458348899, 0.6887255799486933, -3.0062665588539796, 0.7243247279084808, -0.8504083346482413, 1.200683174039521, -0.6918328244588555, -1.0817433412778192, 2.1743296055708083, -0.028261659255404026, -5.789974579264512, 0.9636700965853112, 0.1784850720597243, -2.2640956648570505, 0.564861349378196, -1.16892092597659, -1.0607528151291692, -0.3055740281836779, 1.4766021712190125, 0.49642014646816235, -0.9621599343053532, -0.17535800743761892, 1.3386918568293067, -2.567596560854324, -0.351558424377464, -2.2505658885701147, -1.7182833506058164, 1.0281539540960594, -1.0467249815743909, -0.869204287911254, 0.5091230404294161, -0.34308994664757914, 2.302201589481236, 0.2357437052915773, 2.181954032652949, -3.133456412733561, -0.4094980810998791, -0.0652961964996232, 1.6907257595722132, -1.2662106556987633, -2.346775232126733, -2.0639569179798167, -1.376960554304568, -1.073975167815699, -3.1945241615404694, 0.19918591570081073, -2.2402409674007817, -0.5569721313003059, -1.4420519461501844, -0.7430054130766746, 0.3258954424483289, -3.6130237040759545, 3.2347778825801186, -0.5233389330690594, 0.9663336160246578, -0.1347145437680141, -3.26185989450276, 0.38424668410984203, -0.4052631774552879, 1.413532460824294, 1.716546854190049, -2.5821174527277315, -2.607134529574554, -0.7212483570627557, -0.05972129650623195, -0.34466105472711067, -1.3484786763036367, 4.036181899399189, -0.2017734633457493, -2.6088855672818934, 2.48992958808523, 2.976817588096826, 0.508988247229474, 0.4718459596338629, -0.5784890189030099, -2.2301800363794446, 2.1387745387020116, -1.500138943555368, -0.8738215279054639, 1.3190713839421422, 2.703956027598363, 2.9289569446626995, -0.33122955107244617, -0.5137881471391994, 1.068685968069895,
                },
                {
                        -0.552304217029884, 0.07706333043043356, -0.295864078278925, 0.08311535525749503, -0.8646226078332673, -0.5767558047136114, -0.4654048171255789, 0.47557321874063896, 0.6593098834183633, -0.8556749077221397, 0.8873985464374814, 0.4055526497244717, 0.7119056687131962, 0.69327892285751, 0.8619378002936162, -0.7636390835719373, 0.041248490059991205, -0.023304428820831724, 0.8804662957374672, -0.7152495810852424, -0.3025676071828325, -0.2764037657936642, 0.45318064389575285, -0.3613413300214845, 0.18535881676208055, -0.43544624820708244, 0.9092391047686068, -0.803850260591886, -0.881953351304753, -0.02183716163425853, -0.3854703988949073, 0.8921700457282691, 0.39615146606110696, -0.4158312238453157, -0.9651090062491223, -0.9417515253614908, 0.68352945681899, 0.3973296890618667, -0.846118158747567, 0.6512853438746067, -0.9946755619318206, 0.603352459562368, 0.21708157278913243, 0.6910914884750923, 0.6641942826388822, -0.8219916393057651, -0.4497005574979649, 0.662353297703157, -0.6480639384015867, -0.7572000581001832, -0.7130424499459598, -0.13478461797622088, -0.6720917087146396, -0.5646833852996773, -0.7596956449070562, -0.26031099988619877, 0.8422900349569167, 0.7696812716070942, 0.8690066577662405, 0.04260919671474883, 0.6013568837535586, 0.4722568215055363, 0.31005708925239794, -0.5781211216130246, -0.996405122805228, 0.10004666735163537, 0.7908267754968905, -0.5887450220178438, -0.8803863895058053, 0.8839886159313068, -0.6175183572010869, 0.15994646621034714, 0.9454603663198797, 0.6866077032656497, 0.01987250130657836, 0.3148093296769685, 0.3280785790625571, 0.22325901912858725, -0.011600511073584174, 0.3889409412970999, -0.8567068092297565, -0.7315432097250134, 0.6662417863230103, 0.6789893319785971, -0.19915268236243966, 0.453552284077974, -0.7892654717606034, -0.6654889995759283, 0.9576546141519788, 0.9592879593440424, 0.09056513659918264, -0.4637750188736478, 0.439572689522185, 0.9165218185552231, -0.10914792114979655, 0.9060265617616201, -0.1963572479213418, -0.3493192917856782, -0.3439401958626451, -0.7498591170135431, 0.7168829380243611, -0.9597329464490045, 0.18609391291657174, 0.5278107322130132, 0.3843613819457594, -0.7929897398120691, -0.8361884545736651, -0.45857062632318724, -0.3715826607574775, -0.48498267207846224, 0.767572398529351, -0.7399550382311093, 0.9025384060174746, -0.5714540779721862, 0.510346414080882, 0.9166778439687384, 0.517542825276951, -0.8372144470489968, 0.447285472206461, 0.060909062635374545, -0.33564364940435465, -0.7406992743867615, 0.6065551212272515, -0.3982875146086471, 0.43681384515268196, -0.7724457806595586, -0.47638397755632056, -0.4584804335156636, -0.010443125741334436, 0.21619435334672432, 0.09703232591556077,
                },
                {
                        -0.3962152835418331, 0.20647067857376022, 0.36686200983930917, 1.9772074374890116, -3.5614982070959242, 2.316568525973669, -1.354651768679945, -5.047697687158356, 2.4807512831677823, 0.1530992842755282, -0.07804781724097418, 0.14871866734494466, 0.9385886462660815, 2.221985147616849, -3.5636252042228733, 2.3606545314779175, -3.7957814925453324, -1.4934461836880661, -0.9841350747319768, 1.7150297163575832, -2.0608636635695845, -5.8591846322489145, 3.2360403349716753, -0.37054909637368416, -3.726894260149805, -0.25278976777038614, 0.9032132230200182, 2.590405972235106, -0.14928074519318568, -0.18834526252212724, 2.816251606961924, 1.0866720447515974, -4.04839981667771, 0.7975022533503682, -2.8149210124532686, -0.04816297777022885, 1.5679670229066118, -0.08643801567849024, 1.4408245178451253, 1.753601775304121, 3.630680451232418, 1.817804137216612, -0.5927979549633586, -1.6118142413024126, -1.0016712319725454, 2.388430039937061, -1.773443098820747, -0.25846409512644375, -2.4464311818366773, 1.135174193937421, -4.3150434116827485, 3.4250056584433812, 0.8015880539749186, 3.296255856600228, 1.745705603867687, 1.904103527935971, -0.610422542455382, -1.2810525584110342, 2.168144949734745, 6.298898568801287, 1.6219457501150907, 0.2694496044727404, -1.0448994767155326, 1.4833426102704208, -1.0690487415713634, -2.1155922375951404, -1.3847749238457838, -1.606810125558142, 0.03087653501269849, 2.212352637033526, -0.04390094897186797, -1.8417234399236353, 1.5811033305088493, -0.28545555027473124, -0.550955935610111, 4.498307625675472, 0.8610167154989925, 0.19969603186888485, 3.558408952545733, 1.9123744806163119, 1.3333422787476876, -2.2198520697559907, -4.290614318576003, 0.8633164275869214, 4.21655403236784, -0.21708225355636926, 1.2641322392715801, 0.8708458502023692, -1.2554991825509154, -0.28359303050514056, 3.5416908722756544, 0.9115766893637718, 0.24884235266127502, -1.9109117065413601, 0.0629531895190501, 3.8722391593060825, -2.5985659671177164, 1.515853126902719, 0.09177806055812626, -0.03612504717638884, 0.8392244957335415, 1.8930159623237186E-4, -2.2986042858388593, 0.48250923843482285, 4.635475696249735, -2.824265636699308, -2.447627985278586, 5.2531155993638095, -1.8042366795623128, 2.399140641105655, 2.703219533924482, 0.1577884978421502, -5.94559574866326, 0.6002458674278148, 2.7685678588287566, -0.3482891657397635, -4.047453511241747, -2.8632162713124574, -3.3674828793387594, 1.2633596759916792, -0.12786417113577087, -1.7810302085043477, -1.351112501146968, 6.5756458679753464, -1.321211460708652, -1.7027219417667394, -6.547302290134787, -0.36783411005070915, 2.3268896349524066, 1.2624796914307466, -2.3764032702337405,
                },
                {
                        0.6204264848838643, -0.2270465607864165, -0.805540659999231, 0.2334073274656503, -0.4083261952747823, -0.1784240125883958, 0.5948859724437696, -0.4031591913328203, 0.9620649938619881, -0.07705730240692144, -0.32597472919211357, -0.5303006191940531, 0.258100572030733, 0.1442651055357944, 0.27804657608064187, 0.4593268958851182, -0.8014396295199933, 0.691862809305829, -0.9654365278587569, -0.1252763873419276, -0.5875863621618087, 0.016609023659565292, -0.7596208366530601, 0.4425082024884439, -0.6468350142020867, -0.5788745709448067, -0.08958006956146347, -0.41076498357663005, 0.5486134655640178, 0.5425661774317847, 0.27234107322711143, -0.557773758184519, 0.6941423071034387, 0.844597314009552, 0.7666821246723656, 0.1170960547245381, -0.22070253221297054, 0.8244433112668503, 0.7003358786827505, 0.08865814195607702, -0.5684459345791442, -0.9743628438212577, 0.10148931426912267, -0.5170754924207315, 0.9678105360904283, -0.8556219389627586, -0.9629169966759046, 0.9814182399936264, 0.2632900358138939, -0.47283597945899425, -0.3207728950944124, 0.6950395925721398, -0.5208296144322104, -0.8203656181354184, 0.7449026415686963, -0.15676096793752192, 0.9344039271143414, 0.04132100196733779, 0.5836677939218413, -0.6347318311062053, 0.9638292771989456, 0.7282745569906828, 0.15097772616973848, -0.306206615777987, -0.5261827241669284, 0.20529584389440414, 0.38012012050458366, 0.8371739174506265, 0.08833544708927832, 0.9217693853934106, 0.05365624416785075, -0.35477877209854825, 0.2724536934956556, -0.17013862816630576, 0.1756497882690191, -0.3257281397430343, 0.62695656573754, 0.40110937515801104, -0.9411439227174418, 0.4209225406085495, -0.33313301361412906, -0.7328018745819973, 0.8664340128643675, 0.8597905897723466, 0.8283272897270129, -0.5670205507604289, -0.8143650325573688, -0.8008203878611806, 0.19242414093359472, 0.1445618483578197, 0.36131240100432027, 0.5595450929364936, 0.4711839889643521, -0.5574403520994533, 0.7799875897563975, 0.8831708291121207, -0.8298928145312823, -0.8096421227179893, 0.07059638536737167, 0.799482197837895, 0.5232487863667223, -0.060485769849101256, 0.27593330219674517, -0.6010614242581047, -0.20900491450966485, 0.37918566998065173, -0.55079983748172, 0.9094616320767346, 0.817325441778614, -0.6862681180078083, 0.842955824144985, -0.8771262034117253, -0.6375106893561777, -0.8775848287023034, -0.11684447779163598, -0.9151654729570504, -0.34133017203344296, 0.4773792400781016, 0.4588584279694612, -0.9597204341193941, -0.11965530750895192, 0.7308583316971449, -0.29142757257888197, -0.08261730010310275, -0.22230284205591633, 0.829830513098488, 0.44709632791675213, 0.7365762538640952, 0.5905688685396282, -0.12390265736006123, 0.6521092087358098,
                },
                {
                        -0.665461281420463, -0.39896998716122045, -0.9898928598346932, -0.38260617190272606, -0.5760481078302724, -0.07212135813599074, 0.950888334972197, -0.31764300316126604, -0.7328165427698559, -0.5296370142773346, -0.9185191718391159, -0.8150525585760957, 0.9777503781801593, -0.3785663437683373, -0.5463231854906121, -0.8942228905841223, -0.4569185925684689, 0.7610244959781749, -0.340360959069385, 0.7122072978173759, 0.055750417857038714, 0.8674758201999635, 0.650666938393061, -0.05479030261291973, -0.9272062450522776, -0.5266948169120331, -0.7592817639037885, 0.6791691615233306, 0.36537989755375144, -0.09027814810210555, 0.11261778445098769, 0.6437521313647505, -0.926947666088503, -0.26063955381051573, -0.5719106545635488, -0.4667078184182878, -0.40877941716729826, 0.2942866676095224, -0.011551746865997137, -0.3720275139743403, -0.6024739472149505, -0.6835929840445143, 0.3009967991674487, -0.8875867551045284, -0.5378361484898171, -0.1600086866756365, 0.8768668281576997, -0.7989001220589258, -0.11080588355473386, -0.33890384929040973, 0.6192571848785369, 0.16641641255894868, -0.999670684276613, -0.9937454696926387, 0.25671712895851906, 0.4138761038956529, -0.8003618350039166, -0.6571238554452501, 0.43432967103945375, 0.8604697342057148, -0.3529414979492087, -0.33362047139541184, -0.7036483580750461, 0.045880624860442865, 0.020565695779553694, 0.054156693731530536, 0.17707137552638907, -0.3573581382044626, -0.5387038762043843, -0.2059513474627015, 0.36234650165232996, -0.6698579788804995, 0.1728774703333691, 0.9750872576411542, 0.7924895855651648, 0.3587109811176712, 0.08567202343441749, 0.07083898731540406, 0.04786951546679119, 0.5538477998026996, -0.501408473913785, -0.24923760711614062, -0.00819642259456832, -0.0030210258315490623, 0.6755952017534301, 0.9225704136312607, -0.9589861892713691, 0.16796545680683472, -0.9990639375949746, 0.8386662712533322, 0.1921285828740873, -0.05409745908114849, -0.513326466784646, 0.9922997107078066, 0.6534101773291046, -0.46141277429945093, -0.8220764623365531, 0.4841691067180298, 0.21409430839508659, 0.14735435754276383, 0.31577068838733213, 0.5577722593654209, 0.32942987394326084, 0.9728108046475812, 0.9947191559164212, 0.08188753841737673, -0.6922896996958838, 0.02832672977854611, -0.5089860327190474, -0.09885554615677572, 0.9562910449587303, -0.8480311931317521, -0.5598846205043853, 0.18072191822106887, 0.576791292202198, 0.5938901479423502, -0.39393604651260494, -0.8612109555085541, -0.7046193492465413, 0.6050193895864311, 0.11242554180247533, -0.1096168987775683, -0.6277456635616274, 0.5642187999344277, 0.6939600654875966, 0.5189961177392237, -0.6448950162634801, 0.3549104344529539, -0.21989083481087524, 0.947220510522337, 0.7246003935295355,
                },
                {
                        -0.09740346582303627, 0.5947033296265916, 0.8787349543876848, -0.45433052993488654, -0.8869210454599235, 0.10473880306514483, -0.8804009169936777, -0.11840257460810943, 0.49237240168984076, 0.2929696319242574, 0.3721215610583566, 0.369633896277068, -0.40727836547577967, 0.36478351798359454, -0.40063131528054985, -0.4708116426078197, -0.9210714013861989, -0.4666324029508784, 0.06165566663639854, 0.7783429941840945, -0.7216797301475077, -0.9410368264734299, -0.6946114172512372, -0.9270301060012263, 0.802083633506677, 0.4818784821208397, -0.4829944546210678, 0.5345580228153086, 0.07982601215100171, -0.3994100248998562, 0.5379759844654788, -0.2012544949299362, 0.5730466145319122, 0.7482159107476194, 0.04189625607652414, 0.3497548226459932, -0.5804668092131524, 0.485099002440462, -0.3577031778722688, 0.2016314421155494, -0.6904732668788676, -0.04781185550854139, 0.029855010659324055, 0.9453901561641023, 0.5058239171459429, 0.819362164413705, 0.6302853985054655, 0.4018762678427288, 0.09381623578316689, -0.9852080635133631, -0.27074203761992366, -0.09664815300246232, 0.7837925414353428, -0.764109955066339, -0.47172809692672923, 0.5725204978857394, -0.11334061628972036, -0.3806495992616872, -0.8245081386888518, 0.8759066803607125, 0.445562510089613, -0.11276635488461784, -0.5418692415047552, 0.1992101572867755, 0.9297202649108112, -0.21199304935153496, -0.4519580538192838, 0.22545723361120174, -0.6168919100956289, -0.2841006842661675, 0.959761572483689, -0.5075242926315653, 0.4694616753969223, 0.01888882808080017, 0.7103194457794426, 0.6644214357622213, -0.5336064483199829, -0.3049117854462615, 0.5627160272847642, 0.7727897432366773, -0.0647524383723852, 0.9292514271456755, 0.19004043149182093, -0.03445390075246135, -0.4703580036232684, -0.7644258660574796, -0.8852177118421929, 0.1487149622560262, -0.795518297328285, -0.150082991477535, -0.6420305313106758, -0.6870320603375026, 0.948546938104394, -0.5459689219640007, -0.12465954318346517, 0.30845605705643653, 0.08759490077357746, 0.3163196492503495, -0.9371604447802058, 0.3643339377253647, 0.19123842461714635, -0.5018764442997576, 0.8813004574837406, -0.25487316030163276, -0.3343065369056737, 0.9014690850318012, -0.5197384287872115, 0.5942939482350786, -0.7741832648695488, 0.6236724735765267, 0.5934360454404828, 0.23604617604967326, 0.613681079398614, 0.3361463479621929, -0.5665645712100991, 0.9896776337870181, -0.8327341019336316, -0.7807917903552075, 0.3309262512155624, 0.8963745585414975, 0.14166713177945622, 0.36164276894503145, 0.9434752965335829, 0.6666687025286804, -0.9534403039841357, 0.4732241241215931, -0.49808221361648, -0.37259625103263216, -0.3125265035123581, 0.2603560672701122, -0.7328379739233648,
                },
                {
                        0.017214330104099673, 0.5147440457431689, 0.48613250557880394, -0.7363462892316224, 0.8886808632910757, 0.07160784390423824, -0.4737977279532233, 0.26824607847229753, 0.21233465102324, 0.3875669229387164, 0.7662488700391872, -0.5285732430266488, -0.6189910855740426, -0.23906394861434577, -0.5755800321081814, -0.8441396275048882, 0.6611343757051613, 0.5140984206437622, 0.9667028882940945, -0.8283957538676254, 0.21363954391597684, -0.9321706456684205, -0.44537771486874833, -0.5757943476319582, -0.7518767523700001, -0.8140442359937816, -0.5622370691135417, 0.3244250687442003, 0.9104579235328769, 0.8132641454614757, 0.3531924637566404, -0.376525202653913, 0.5684356827923678, 0.6971472847912878, 0.5895580443036164, -0.39351013493726517, 0.7870219494441735, 0.8135594060464226, 0.5318372038497818, -0.7717229661916134, -0.5257652512540067, 0.5104256993989742, -0.7765754284125264, -0.5507848764056795, 0.4306209224031101, 0.23673229202733004, 0.7654394394328028, 0.7655085017521712, -0.1502463680310373, 0.7430992234562495, 0.21884339875080983, -0.273176595237693, 0.19412821335073516, -0.28028190848210843, 0.08315829947717868, 0.09566516554573745, 0.31028755234234606, -0.019886487489694682, 0.3962806460941255, 0.2266821074332772, -0.3510397936040792, -0.4957332130152232, 0.033088646757686524, -0.7695893457271288, -0.9795518328864232, -0.07778376629299721, -0.12375584586914812, 0.5348034418684533, 0.44245444443849213, 0.3493292377085253, 0.19079259268788773, 0.5692114456377992, 0.3269931698176278, -0.12298260790860027, 0.7548683000932532, 0.46931798209117215, -0.4950210733254181, 0.4777446942769925, -0.917984248647818, -0.062148006335740025, 0.4015437970796101, 0.6007576187458201, -0.5836604605696705, 0.6947345059374348, 0.05208567696447686, 0.3150427352206202, -0.9100997714603278, 0.3116421992566112, -0.4114976919780984, -0.5014030963475846, -0.6975246874218219, -0.3502018469462891, 0.32702048759858027, -0.7218278726970737, 0.417007749744817, 0.6061296897461133, -0.34651789550405065, -0.3087636171729673, -0.5402310352661372, -0.578239899152674, 0.5289015849127336, -0.6280312988023176, -0.3275359264260769, 0.4181297684263032, 0.6275634360303672, -0.04431429268517695, 0.6842126483609934, -0.3001294348638104, 0.8718801792709654, 0.851175027188241, -0.8454611455183301, 0.09988471043905744, 0.4426863593376662, -0.9520118285392662, -0.41578871170826104, -0.5590918980142203, 0.2205943494658822, -0.2941754064319142, -0.6010282116476615, 0.049166025974475724, -0.9465057908043719, 0.41571658998130867, -0.6181001675267794, 0.3795574496138123, -0.7527701649976153, -0.7721976961974086, 0.06335883232090733, -0.40186861795265383, -0.7590605557392438, -0.19194767523163425, 0.7731761678684288,
                }
        };

        if (rc.getType() == RobotType.SOLDIER)
        {
            net = new FeedForwardNeuralNet(weights[0]);
        }
        else if (rc.getType() == RobotType.ARCHON)
        {
            net = new FeedForwardNeuralNet(weights[1]);
        }
        else if (rc.getType() == RobotType.GUARD)
        {
            net = new FeedForwardNeuralNet(weights[2]);
        }
        else if (rc.getType() == RobotType.SCOUT)
        {
            net = new FeedForwardNeuralNet(weights[3]);
        }
        else if (rc.getType() == RobotType.TURRET)
        {
            net = new FeedForwardNeuralNet(weights[4]);
        }
        else if (rc.getType() == RobotType.TTM)
        {
            net = new FeedForwardNeuralNet(weights[5]);
        }
        else if (rc.getType() == RobotType.VIPER)
        {
            net = new FeedForwardNeuralNet(weights[6]);
        }
    }

    public boolean basicFightMicro(RobotInfo[] nearByEnemies) throws GameActionException
    {
        if (nearByEnemies != null && nearByEnemies.length > 0)
        {
            for (int i = 0; i < nearByEnemies.length; i++)
            {
                if (rc.canAttackLocation(nearByEnemies[i].location))
                {
                    rc.attackLocation(nearByEnemies[i].location);
                    return true;
                }
            }
        }

        return false;
    }

    public boolean basicNetFightMicro(RobotInfo[] nearByEnemies, RobotInfo[] nearByAllies, RobotInfo[] enemies, RobotInfo[] allies, MapLocation target) throws GameActionException
    {
        if (enemies == null || enemies.length == 0)
        {
            return false;
        }

        double alliedHealth = 0;
        double enemyHealth = 0;
        double offensiveEnemies = 0;
        double enemiesInRangeOfUs = 0;
        int enemy_x = 0;
        int enemy_y = 0;
        int ally_x = 0;
        int ally_y = 0;

        for (int i = allies.length; --i >= 0; )
        {
            alliedHealth += allies[i].health;
            ally_x += allies[i].location.x;
            ally_y += allies[i].location.y;
        }

        if (allies.length > 0)
        {
            ally_x /= allies.length;
            ally_y /= allies.length;
        }

        for (int i = 0; i < enemies.length; i++)
        {
            enemy_x += enemies[i].location.x;
            enemy_y += enemies[i].location.y;
            switch(enemies[i].type)
            {
                case VIPER:
                case SOLDIER:
                case GUARD:
                case BIGZOMBIE:
                case FASTZOMBIE:
                case STANDARDZOMBIE:
                case RANGEDZOMBIE:
                case TURRET:
                    offensiveEnemies++;
                    enemyHealth += enemies[i].health;
                    if (rc.getLocation().distanceSquaredTo(enemies[i].location) <= enemies[i].type.attackRadiusSquared)
                        enemiesInRangeOfUs++;
            }
        }


        enemy_x /= enemies.length;
        enemy_y /= enemies.length;


        double[] inputs = new double[] {
                offensiveEnemies / 10,
                allies.length / 10,
                alliedHealth / 10,
                enemyHealth / 10,
                nearByEnemies.length / 10,
                offensiveEnemies / 10
        };

        Direction dir;

        boolean retreat = false;
        boolean advance = false;
        boolean cluster = false;
        boolean pursue = false;
        double[] output = net.compute(inputs);

        // retreat
        if (output[0] > 0.5)
        {
            retreat = true;
        }

        // advance
        if (output[1] > 0.5) {
            advance = true;
        }

        // cluster
        if (output[2] > 0.5) {
            cluster = true;
        }

        // pursue
        if (output[3] > 0.5) {
            pursue = true;
        }

        if (rc.isCoreReady()) {
            if (retreat) {
                MapLocation enemy = new MapLocation(enemy_x, enemy_y);
                dir = rc.getLocation().directionTo(enemy).opposite();
                FightMicroUtilites.moveDir(rc, dir);
                rc.setIndicatorString(2, "retreat");
            }

            if (rc.isCoreReady() && cluster) {
                MapLocation ally = new MapLocation(ally_x, ally_y);
                dir = rc.getLocation().directionTo(ally);
                FightMicroUtilites.moveDir(rc, dir);
                rc.setIndicatorString(2, "Cluster");
            }

            if (rc.isCoreReady() && advance) {
                dir = FightMicroUtilites.getDir(rc, target);
                FightMicroUtilites.moveDir(rc, dir);
                rc.setIndicatorString(2, "Advance");
            }

            if (rc.isCoreReady() && pursue) {
                MapLocation enemy = new MapLocation(enemy_x, enemy_y);
                dir = rc.getLocation().directionTo(enemy);
                FightMicroUtilites.moveDir(rc, dir);
                rc.setIndicatorString(2, "Pursue");
            }
        }

        rc.setIndicatorString(1, "" + rc.isWeaponReady() + " " + nearByEnemies.length);
        if (rc.isWeaponReady() && nearByEnemies.length > 0) {
            rc.setIndicatorString(1, "Attacking");
            try {
                RobotInfo weakEnemy = FightMicroUtilites.findWeakestEnemy(nearByEnemies);
                if (weakEnemy != null) {
                    MapLocation attackSpot = weakEnemy.location;
                    if (attackSpot != null && rc.canAttackLocation(attackSpot)) {
                        rc.attackLocation(attackSpot);
                    }
                }
            } catch (Exception e) {
                System.out.println("failed when trying to attack");
                e.printStackTrace();
            }
        }
        return true;
    }
}
