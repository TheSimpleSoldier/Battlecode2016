package team037;

import battlecode.common.*;
import team037.NeuralNet.FeedForwardNeuralNet;
import team037.Utilites.FightMicroUtilites;

public class FightMicro
{
    public static RobotController rc;
    public static FeedForwardNeuralNet net;
    public static double[][] weights;

    public FightMicro(RobotController robotController)
    {
        rc = robotController;
        weights = new double[][] {
                {
                        6.279491765547804E21, -3.459976484012189E21, 6.69057232213489E21, -3.0789276878810317E22, -1.6829970222554487E22, -4.371992492736181E22, -8.566778699409721E21, -2.5724075604982595E22, -9.350313306324742E21, 1.1548143753688181E22, -3.0673231646627723E22, -2.9977825421718226E22, -3.6450240264832323E21, 5.752741515723002E21, -2.793099741881906E22, 4.0616343584665135E21, -1.3849670886459556E22, -3.4818760652482505E22, -3.150882446628284E22, 4.1450867022917943E21, 1.484905884984415E22, -4.814857861207508E21, -9.460266976133226E21, 6.913517867320744E21, 1.535422745941895E22, 3.19916546161092E22, -6.706262841272824E21, 1.807038612297986E22, -3.457814778084792E22, -6.914411652736333E21, -3.544983395785068E22, -2.736473903433462E21, 9.72540459366184E21, -2.8186862383436194E21, 4.502504237195704E20, -1.1155576299869864E22, 1.5596573347017107E22, 4.239071197245918E21, 4.679517670840776E22, -2.785799276731429E22, -1.5320167089568131E22, 1.6786144835662832E21, -3.482817305759206E22, 8.175721554264719E21, 1.6733648019342703E22, -1.1852410333601955E22, -4.328264938816331E21, -2.0899511166692665E22, -7.604782163382102E21, 4.970759115958681E21, -7.738130218114853E20, 2.5638362416330406E22, 1.1544107125146382E22, -2.705037925963971E22, 1.703929033672674E22, 6.920540893177802E21, 2.441824558668802E22, 7.118086262463615E21, -3.828065932047398E22, -3.010632688602294E22, 9.401767942801987E21, -1.6334605452365026E22, 3.1193443971136074E22, -9.310374252612295E20, 8.473310658957124E21, 8.459140303108905E21, 1.9394091020621583E22, -1.9195769821025356E22, 8.094491962387342E21, -2.4710079407310466E22, 3.6354816344817104E22, -2.8212006139059453E22, 1.4192925515957198E22, 3.506568170048813E22, -8.289729092116172E21, -2.406513957687364E22, -2.2543081640946943E22, -2.5770584902407803E22, -3.3423328326722177E22, 2.874124557312704E22, 4.1726416385295967E21, -4.416513840063735E22, -2.312364034516213E22, -4.01031899999754E21, -8.378325027758127E20, -1.4075191459538394E22, 3.2841680132777403E22, 1.9248241953733406E22, 4.237171985870806E22, 1.144476866538655E22, -2.5505120211665276E22, 2.469147779362485E21, -4.336304440444795E22, 1.2006274378581336E22, 1.1930505953638634E22, 3.8046451978390454E19, -1.462699731535603E22, 3.6444084211391654E22, -3.3431355829558245E22, -3.264829520835106E22, -2.203258522487097E22, -8.004566355756676E21, 2.7390213785225032E22, -3.962184861081084E22, 3.257368379532004E22, 1.8529096520387738E22, -1.6850874198479813E22, -4.1649745069258336E21, 2.2376179279617166E22, 3.0974783990755945E22, 8.00922882360947E20, -4.9138496713297865E22, -9.315943538814506E19, 7.949696169983086E21, 3.5787261067253934E22, 2.5018269981108167E22, 7.813855748076509E21, 1.6504080740456873E21, -2.206799971997865E22, 3.094276395621029E22, 1.5278003681335E22, 9.553783668314842E21, 3.4278896913847186E22, 1.4666110007496715E22, -1.044899962130366E22, -2.634911384160871E21, 5.765496362269434E22, 2.484351750027781E22, 2.0621351038900815E22, 2.50819924311145E22, -4.247245996706684E22,
                },
                {
                        -0.552304217029884, 0.07706333043043356, -0.295864078278925, 0.08311535525749503, -0.8646226078332673, -0.5767558047136114, -0.4654048171255789, 0.47557321874063896, 0.6593098834183633, -0.8556749077221397, 0.8873985464374814, 0.4055526497244717, 0.7119056687131962, 0.69327892285751, 0.8619378002936162, -0.7636390835719373, 0.041248490059991205, -0.023304428820831724, 0.8804662957374672, -0.7152495810852424, -0.3025676071828325, -0.2764037657936642, 0.45318064389575285, -0.3613413300214845, 0.18535881676208055, -0.43544624820708244, 0.9092391047686068, -0.803850260591886, -0.881953351304753, -0.02183716163425853, -0.3854703988949073, 0.8921700457282691, 0.39615146606110696, -0.4158312238453157, -0.9651090062491223, -0.9417515253614908, 0.68352945681899, 0.3973296890618667, -0.846118158747567, 0.6512853438746067, -0.9946755619318206, 0.603352459562368, 0.21708157278913243, 0.6910914884750923, 0.6641942826388822, -0.8219916393057651, -0.4497005574979649, 0.662353297703157, -0.6480639384015867, -0.7572000581001832, -0.7130424499459598, -0.13478461797622088, -0.6720917087146396, -0.5646833852996773, -0.7596956449070562, -0.26031099988619877, 0.8422900349569167, 0.7696812716070942, 0.8690066577662405, 0.04260919671474883, 0.6013568837535586, 0.4722568215055363, 0.31005708925239794, -0.5781211216130246, -0.996405122805228, 0.10004666735163537, 0.7908267754968905, -0.5887450220178438, -0.8803863895058053, 0.8839886159313068, -0.6175183572010869, 0.15994646621034714, 0.9454603663198797, 0.6866077032656497, 0.01987250130657836, 0.3148093296769685, 0.3280785790625571, 0.22325901912858725, -0.011600511073584174, 0.3889409412970999, -0.8567068092297565, -0.7315432097250134, 0.6662417863230103, 0.6789893319785971, -0.19915268236243966, 0.453552284077974, -0.7892654717606034, -0.6654889995759283, 0.9576546141519788, 0.9592879593440424, 0.09056513659918264, -0.4637750188736478, 0.439572689522185, 0.9165218185552231, -0.10914792114979655, 0.9060265617616201, -0.1963572479213418, -0.3493192917856782, -0.3439401958626451, -0.7498591170135431, 0.7168829380243611, -0.9597329464490045, 0.18609391291657174, 0.5278107322130132, 0.3843613819457594, -0.7929897398120691, -0.8361884545736651, -0.45857062632318724, -0.3715826607574775, -0.48498267207846224, 0.767572398529351, -0.7399550382311093, 0.9025384060174746, -0.5714540779721862, 0.510346414080882, 0.9166778439687384, 0.517542825276951, -0.8372144470489968, 0.447285472206461, 0.060909062635374545, -0.33564364940435465, -0.7406992743867615, 0.6065551212272515, -0.3982875146086471, 0.43681384515268196, -0.7724457806595586, -0.47638397755632056, -0.4584804335156636, -0.010443125741334436, 0.21619435334672432, 0.09703232591556077,
                },
                {
                        -0.5265797626480562, 0.7438632504106506, 0.388302425938178, -0.7836579582441319, -0.1799686770869069, 0.6692965915505096, -0.5560848243159076, -0.9657766795992044, 0.056015559415787175, 0.7676839458251457, 0.9666798802452945, 0.4087082765670562, 0.7413349416922344, 0.2735786098812527, -0.7505708264473245, -0.9444572528238988, -0.46283088732096767, 0.5221834191595174, -0.8595298122056085, -0.9269984633108246, 0.056419445876631835, -0.08253937442902126, -0.5691520524358042, 0.3737367990880245, -0.8860811082766327, 0.11642977739234395, -0.616223297477531, -0.005534023714953262, 0.42035393390776354, 0.7065709103612159, -0.6112776277558958, -0.39954453129395673, -0.5935163512053545, 0.12395202820769202, -0.8535531762783999, -0.9962909486116243, 0.5693176130509663, -0.40709592713052123, 0.27765334867787717, 0.5782217289030718, -0.5005057617859561, 0.46376909767141417, 0.7967007854914026, 0.08261507271738422, 0.5791774698371612, -0.5165495742163626, 0.5031810007276016, -0.4100784347229969, 0.2323700937534816, -0.745802530473554, -0.9820156945299912, -0.023760625605474095, 0.5646171128153104, 0.41925974254122855, -0.07319642663552761, -0.2655685152143423, -0.7533459405302783, -0.04025072572571853, -0.7071428843428691, -0.2440027989708109, 0.5766302055504229, 0.3952520847523686, 0.6619387898129863, 0.1636961315623766, -0.20188262856930583, -0.3485659654327875, -0.39326978974389637, -0.7205414677543995, -0.04380927684039815, 0.8910883890755039, 0.8436403422462284, 0.37656876753936697, -0.15855179545644416, -0.2992240006133571, 0.004264176075206683, 0.9920620083396807, 0.9019121241176042, 0.6834126752407879, 0.2548811551409511, 0.26472690611932803, 0.3953348517611288, 0.7278598115960613, -0.8687586042883371, 0.016060502350411676, -0.490491360800114, 0.009779502703478382, -0.8077827267764284, -0.8940246054135317, 0.6957579184517102, 0.12371714169856318, -0.6052759132727337, -0.027989764369236836, 0.040870575579502244, -0.3454221627324314, 0.4536436107844366, -0.7997496489154654, 0.1453022266798636, 0.9673666002538319, 0.8743110117425181, 0.4781166825583152, 0.6805664952191344, 0.027264850853914613, 0.8314546841345842, 0.3436348064403243, -0.4336979179737095, -0.3421807213375978, 0.617305642222088, 0.7727492061741095, -0.46241525328010313, -0.19677821567144638, 0.9929229497903382, -0.16429948535725236, 0.76563216231631, 0.08136296092901918, 0.45060749329139416, 0.405437387267801, 0.15012630079736233, 0.19754415976909456, -0.8683932474271199, -0.7845131134359589, -0.08104391353919405, 0.634436715362982, 0.9421398444907907, 0.4416610334011273, 0.25126257554051645, -0.5579206189442925, 0.27210078933019277, -0.5785698154701497, 0.7822456529360635, 0.922409281356317, -0.35537379544291525,
                },
                {
                        0.6204264848838643, -0.2270465607864165, -0.805540659999231, 0.2334073274656503, -0.4083261952747823, -0.1784240125883958, 0.5948859724437696, -0.4031591913328203, 0.9620649938619881, -0.07705730240692144, -0.32597472919211357, -0.5303006191940531, 0.258100572030733, 0.1442651055357944, 0.27804657608064187, 0.4593268958851182, -0.8014396295199933, 0.691862809305829, -0.9654365278587569, -0.1252763873419276, -0.5875863621618087, 0.016609023659565292, -0.7596208366530601, 0.4425082024884439, -0.6468350142020867, -0.5788745709448067, -0.08958006956146347, -0.41076498357663005, 0.5486134655640178, 0.5425661774317847, 0.27234107322711143, -0.557773758184519, 0.6941423071034387, 0.844597314009552, 0.7666821246723656, 0.1170960547245381, -0.22070253221297054, 0.8244433112668503, 0.7003358786827505, 0.08865814195607702, -0.5684459345791442, -0.9743628438212577, 0.10148931426912267, -0.5170754924207315, 0.9678105360904283, -0.8556219389627586, -0.9629169966759046, 0.9814182399936264, 0.2632900358138939, -0.47283597945899425, -0.3207728950944124, 0.6950395925721398, -0.5208296144322104, -0.8203656181354184, 0.7449026415686963, -0.15676096793752192, 0.9344039271143414, 0.04132100196733779, 0.5836677939218413, -0.6347318311062053, 0.9638292771989456, 0.7282745569906828, 0.15097772616973848, -0.306206615777987, -0.5261827241669284, 0.20529584389440414, 0.38012012050458366, 0.8371739174506265, 0.08833544708927832, 0.9217693853934106, 0.05365624416785075, -0.35477877209854825, 0.2724536934956556, -0.17013862816630576, 0.1756497882690191, -0.3257281397430343, 0.62695656573754, 0.40110937515801104, -0.9411439227174418, 0.4209225406085495, -0.33313301361412906, -0.7328018745819973, 0.8664340128643675, 0.8597905897723466, 0.8283272897270129, -0.5670205507604289, -0.8143650325573688, -0.8008203878611806, 0.19242414093359472, 0.1445618483578197, 0.36131240100432027, 0.5595450929364936, 0.4711839889643521, -0.5574403520994533, 0.7799875897563975, 0.8831708291121207, -0.8298928145312823, -0.8096421227179893, 0.07059638536737167, 0.799482197837895, 0.5232487863667223, -0.060485769849101256, 0.27593330219674517, -0.6010614242581047, -0.20900491450966485, 0.37918566998065173, -0.55079983748172, 0.9094616320767346, 0.817325441778614, -0.6862681180078083, 0.842955824144985, -0.8771262034117253, -0.6375106893561777, -0.8775848287023034, -0.11684447779163598, -0.9151654729570504, -0.34133017203344296, 0.4773792400781016, 0.4588584279694612, -0.9597204341193941, -0.11965530750895192, 0.7308583316971449, -0.29142757257888197, -0.08261730010310275, -0.22230284205591633, 0.829830513098488, 0.44709632791675213, 0.7365762538640952, 0.5905688685396282, -0.12390265736006123, 0.6521092087358098,
                },
                {
                        -0.665461281420463, -0.39896998716122045, -0.9898928598346932, -0.38260617190272606, -0.5760481078302724, -0.07212135813599074, 0.950888334972197, -0.31764300316126604, -0.7328165427698559, -0.5296370142773346, -0.9185191718391159, -0.8150525585760957, 0.9777503781801593, -0.3785663437683373, -0.5463231854906121, -0.8942228905841223, -0.4569185925684689, 0.7610244959781749, -0.340360959069385, 0.7122072978173759, 0.055750417857038714, 0.8674758201999635, 0.650666938393061, -0.05479030261291973, -0.9272062450522776, -0.5266948169120331, -0.7592817639037885, 0.6791691615233306, 0.36537989755375144, -0.09027814810210555, 0.11261778445098769, 0.6437521313647505, -0.926947666088503, -0.26063955381051573, -0.5719106545635488, -0.4667078184182878, -0.40877941716729826, 0.2942866676095224, -0.011551746865997137, -0.3720275139743403, -0.6024739472149505, -0.6835929840445143, 0.3009967991674487, -0.8875867551045284, -0.5378361484898171, -0.1600086866756365, 0.8768668281576997, -0.7989001220589258, -0.11080588355473386, -0.33890384929040973, 0.6192571848785369, 0.16641641255894868, -0.999670684276613, -0.9937454696926387, 0.25671712895851906, 0.4138761038956529, -0.8003618350039166, -0.6571238554452501, 0.43432967103945375, 0.8604697342057148, -0.3529414979492087, -0.33362047139541184, -0.7036483580750461, 0.045880624860442865, 0.020565695779553694, 0.054156693731530536, 0.17707137552638907, -0.3573581382044626, -0.5387038762043843, -0.2059513474627015, 0.36234650165232996, -0.6698579788804995, 0.1728774703333691, 0.9750872576411542, 0.7924895855651648, 0.3587109811176712, 0.08567202343441749, 0.07083898731540406, 0.04786951546679119, 0.5538477998026996, -0.501408473913785, -0.24923760711614062, -0.00819642259456832, -0.0030210258315490623, 0.6755952017534301, 0.9225704136312607, -0.9589861892713691, 0.16796545680683472, -0.9990639375949746, 0.8386662712533322, 0.1921285828740873, -0.05409745908114849, -0.513326466784646, 0.9922997107078066, 0.6534101773291046, -0.46141277429945093, -0.8220764623365531, 0.4841691067180298, 0.21409430839508659, 0.14735435754276383, 0.31577068838733213, 0.5577722593654209, 0.32942987394326084, 0.9728108046475812, 0.9947191559164212, 0.08188753841737673, -0.6922896996958838, 0.02832672977854611, -0.5089860327190474, -0.09885554615677572, 0.9562910449587303, -0.8480311931317521, -0.5598846205043853, 0.18072191822106887, 0.576791292202198, 0.5938901479423502, -0.39393604651260494, -0.8612109555085541, -0.7046193492465413, 0.6050193895864311, 0.11242554180247533, -0.1096168987775683, -0.6277456635616274, 0.5642187999344277, 0.6939600654875966, 0.5189961177392237, -0.6448950162634801, 0.3549104344529539, -0.21989083481087524, 0.947220510522337, 0.7246003935295355,
                },
                {
                        -0.09740346582303627, 0.5947033296265916, 0.8787349543876848, -0.45433052993488654, -0.8869210454599235, 0.10473880306514483, -0.8804009169936777, -0.11840257460810943, 0.49237240168984076, 0.2929696319242574, 0.3721215610583566, 0.369633896277068, -0.40727836547577967, 0.36478351798359454, -0.40063131528054985, -0.4708116426078197, -0.9210714013861989, -0.4666324029508784, 0.06165566663639854, 0.7783429941840945, -0.7216797301475077, -0.9410368264734299, -0.6946114172512372, -0.9270301060012263, 0.802083633506677, 0.4818784821208397, -0.4829944546210678, 0.5345580228153086, 0.07982601215100171, -0.3994100248998562, 0.5379759844654788, -0.2012544949299362, 0.5730466145319122, 0.7482159107476194, 0.04189625607652414, 0.3497548226459932, -0.5804668092131524, 0.485099002440462, -0.3577031778722688, 0.2016314421155494, -0.6904732668788676, -0.04781185550854139, 0.029855010659324055, 0.9453901561641023, 0.5058239171459429, 0.819362164413705, 0.6302853985054655, 0.4018762678427288, 0.09381623578316689, -0.9852080635133631, -0.27074203761992366, -0.09664815300246232, 0.7837925414353428, -0.764109955066339, -0.47172809692672923, 0.5725204978857394, -0.11334061628972036, -0.3806495992616872, -0.8245081386888518, 0.8759066803607125, 0.445562510089613, -0.11276635488461784, -0.5418692415047552, 0.1992101572867755, 0.9297202649108112, -0.21199304935153496, -0.4519580538192838, 0.22545723361120174, -0.6168919100956289, -0.2841006842661675, 0.959761572483689, -0.5075242926315653, 0.4694616753969223, 0.01888882808080017, 0.7103194457794426, 0.6644214357622213, -0.5336064483199829, -0.3049117854462615, 0.5627160272847642, 0.7727897432366773, -0.0647524383723852, 0.9292514271456755, 0.19004043149182093, -0.03445390075246135, -0.4703580036232684, -0.7644258660574796, -0.8852177118421929, 0.1487149622560262, -0.795518297328285, -0.150082991477535, -0.6420305313106758, -0.6870320603375026, 0.948546938104394, -0.5459689219640007, -0.12465954318346517, 0.30845605705643653, 0.08759490077357746, 0.3163196492503495, -0.9371604447802058, 0.3643339377253647, 0.19123842461714635, -0.5018764442997576, 0.8813004574837406, -0.25487316030163276, -0.3343065369056737, 0.9014690850318012, -0.5197384287872115, 0.5942939482350786, -0.7741832648695488, 0.6236724735765267, 0.5934360454404828, 0.23604617604967326, 0.613681079398614, 0.3361463479621929, -0.5665645712100991, 0.9896776337870181, -0.8327341019336316, -0.7807917903552075, 0.3309262512155624, 0.8963745585414975, 0.14166713177945622, 0.36164276894503145, 0.9434752965335829, 0.6666687025286804, -0.9534403039841357, 0.4732241241215931, -0.49808221361648, -0.37259625103263216, -0.3125265035123581, 0.2603560672701122, -0.7328379739233648,
                },
                {
                        0.017214330104099673, 0.5147440457431689, 0.48613250557880394, -0.7363462892316224, 0.8886808632910757, 0.07160784390423824, -0.4737977279532233, 0.26824607847229753, 0.21233465102324, 0.3875669229387164, 0.7662488700391872, -0.5285732430266488, -0.6189910855740426, -0.23906394861434577, -0.5755800321081814, -0.8441396275048882, 0.6611343757051613, 0.5140984206437622, 0.9667028882940945, -0.8283957538676254, 0.21363954391597684, -0.9321706456684205, -0.44537771486874833, -0.5757943476319582, -0.7518767523700001, -0.8140442359937816, -0.5622370691135417, 0.3244250687442003, 0.9104579235328769, 0.8132641454614757, 0.3531924637566404, -0.376525202653913, 0.5684356827923678, 0.6971472847912878, 0.5895580443036164, -0.39351013493726517, 0.7870219494441735, 0.8135594060464226, 0.5318372038497818, -0.7717229661916134, -0.5257652512540067, 0.5104256993989742, -0.7765754284125264, -0.5507848764056795, 0.4306209224031101, 0.23673229202733004, 0.7654394394328028, 0.7655085017521712, -0.1502463680310373, 0.7430992234562495, 0.21884339875080983, -0.273176595237693, 0.19412821335073516, -0.28028190848210843, 0.08315829947717868, 0.09566516554573745, 0.31028755234234606, -0.019886487489694682, 0.3962806460941255, 0.2266821074332772, -0.3510397936040792, -0.4957332130152232, 0.033088646757686524, -0.7695893457271288, -0.9795518328864232, -0.07778376629299721, -0.12375584586914812, 0.5348034418684533, 0.44245444443849213, 0.3493292377085253, 0.19079259268788773, 0.5692114456377992, 0.3269931698176278, -0.12298260790860027, 0.7548683000932532, 0.46931798209117215, -0.4950210733254181, 0.4777446942769925, -0.917984248647818, -0.062148006335740025, 0.4015437970796101, 0.6007576187458201, -0.5836604605696705, 0.6947345059374348, 0.05208567696447686, 0.3150427352206202, -0.9100997714603278, 0.3116421992566112, -0.4114976919780984, -0.5014030963475846, -0.6975246874218219, -0.3502018469462891, 0.32702048759858027, -0.7218278726970737, 0.417007749744817, 0.6061296897461133, -0.34651789550405065, -0.3087636171729673, -0.5402310352661372, -0.578239899152674, 0.5289015849127336, -0.6280312988023176, -0.3275359264260769, 0.4181297684263032, 0.6275634360303672, -0.04431429268517695, 0.6842126483609934, -0.3001294348638104, 0.8718801792709654, 0.851175027188241, -0.8454611455183301, 0.09988471043905744, 0.4426863593376662, -0.9520118285392662, -0.41578871170826104, -0.5590918980142203, 0.2205943494658822, -0.2941754064319142, -0.6010282116476615, 0.049166025974475724, -0.9465057908043719, 0.41571658998130867, -0.6181001675267794, 0.3795574496138123, -0.7527701649976153, -0.7721976961974086, 0.06335883232090733, -0.40186861795265383, -0.7590605557392438, -0.19194767523163425, 0.7731761678684288,
                }
        };

        if (rc.getType() == RobotType.SOLDIER)
        {
            net = new FeedForwardNeuralNet(weights[0]);
        }
        else if (rc.getType() == RobotType.ARCHON)
        {
            net = new FeedForwardNeuralNet(weights[1]);
        }
        else if (rc.getType() == RobotType.GUARD)
        {
            net = new FeedForwardNeuralNet(weights[2]);
        }
        else if (rc.getType() == RobotType.SCOUT)
        {
            net = new FeedForwardNeuralNet(weights[3]);
        }
        else if (rc.getType() == RobotType.TURRET)
        {
            net = new FeedForwardNeuralNet(weights[4]);
        }
        else if (rc.getType() == RobotType.TTM)
        {
            net = new FeedForwardNeuralNet(weights[5]);
        }
        else if (rc.getType() == RobotType.VIPER)
        {
            net = new FeedForwardNeuralNet(weights[6]);
        }
    }

    public boolean basicFightMicro(RobotInfo[] nearByEnemies) throws GameActionException
    {
        if (nearByEnemies != null && nearByEnemies.length > 0)
        {
            for (int i = 0; i < nearByEnemies.length; i++)
            {
                if (rc.canAttackLocation(nearByEnemies[i].location))
                {
                    rc.attackLocation(nearByEnemies[i].location);
                    return true;
                }
            }
        }

        return false;
    }

    // TODO: create fight micro using a trained neural net
    public boolean basicNetFightMicro(RobotInfo[] nearByEnemies, RobotInfo[] nearByAllies, RobotInfo[] enemies, RobotInfo[] allies, MapLocation target) throws GameActionException
    {
        if (enemies == null || enemies.length == 0)
        {
            return false;
        }

        double alliedHealth = 0;

        for (int i = allies.length; --i >= 0; )
        {
            alliedHealth += allies[i].health;
        }

        double enemyHealth = 0;

        for (int i = enemies.length; --i >= 0; )
        {
            enemyHealth += enemies[i].health;
        }

        double[] inputs = new double[] {
                enemies.length / 10,
                allies.length / 10,
                alliedHealth / 10,
                enemyHealth / 10,
                nearByEnemies.length / 10,
                nearByAllies.length / 10
        };

        Direction dir;

        boolean retreat = false;
        boolean advance = false;
        boolean cluster = false;
        boolean pursue = false;
        double[] output = net.compute(inputs);

        // retreat
        if (output[0] > 0.5)
        {
            retreat = true;
        }

        // advance
        if (output[1] > 0.5) {
            advance = true;
        }

        // cluster
        if (output[2] > 0.5) {
            cluster = true;
        }

        // pursue
        if (output[3] > 0.5) {
            pursue = true;
        }

        if (rc.isCoreReady()) {
            if (retreat) {
                MapLocation enemy = new MapLocation((int) inputs[0] + rc.getLocation().x, (int) inputs[1] + rc.getLocation().y);
                dir = rc.getLocation().directionTo(enemy).opposite();
                FightMicroUtilites.moveDir(rc, dir);
            }

            if (rc.isCoreReady() && cluster) {
                MapLocation ally = new MapLocation((int) inputs[2] + rc.getLocation().x, (int) inputs[3] + rc.getLocation().y);
                dir = rc.getLocation().directionTo(ally);
                FightMicroUtilites.moveDir(rc, dir);
            }

            if (rc.isCoreReady() && advance) {
                dir = FightMicroUtilites.getDir(rc, target);
                FightMicroUtilites.moveDir(rc, dir);
            }

            if (rc.isCoreReady() && pursue) {
                MapLocation enemy = new MapLocation((int) inputs[0] + rc.getLocation().x, (int) inputs[1] + rc.getLocation().y);
                dir = rc.getLocation().directionTo(enemy);
                FightMicroUtilites.moveDir(rc, dir);
            }
        }


        if (rc.isWeaponReady() && nearByEnemies.length > 0) {
            try {
                RobotInfo weakEnemy = FightMicroUtilites.findWeakestEnemy(nearByEnemies);
                if (weakEnemy != null) {
                    MapLocation attackSpot = weakEnemy.location;
                    if (attackSpot != null && rc.canAttackLocation(attackSpot)) {
                        rc.attackLocation(attackSpot);
                    }
                }
            } catch (Exception e) {
                System.out.println("failed when trying to attack");
                e.printStackTrace();
            }
        }
        return true;
    }
}
